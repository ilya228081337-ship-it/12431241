# Развертывание на Netlify

## Быстрый старт

1. **Подготовка проекта**
   ```bash
   npm run build
   ```

2. **Настройка Netlify**
   - Зарегистрируйтесь на [netlify.com](https://netlify.com)
   - Нажмите "Add new site" → "Deploy manually"
   - Перетащите папку `dist` в окно загрузки

3. **Настройка переменных окружения**
   - В настройках сайта: Site settings → Environment variables
   - Добавьте:
     - `VITE_SUPABASE_URL` - ваш Supabase URL
     - `VITE_SUPABASE_ANON_KEY` - ваш Supabase Anon Key

4. **Настройка редиректов**
   Создайте файл `public/_redirects`:
   ```
   /*    /index.html   200
   ```

## Автоматическое развертывание через Git

1. **Подключите репозиторий**
   - В Netlify: "Add new site" → "Import an existing project"
   - Выберите GitHub/GitLab/Bitbucket
   - Выберите ваш репозиторий

2. **Настройки сборки**
   - Build command: `npm run build`
   - Publish directory: `dist`
   - Добавьте переменные окружения (см. выше)

3. **Deploy**
   - Netlify автоматически соберет и развернет проект
   - При каждом push в main ветку будет автоматический деплой

## Важные требования для работы

### 1. HTTPS обязателен
Web Speech API работает **только через HTTPS**. Netlify автоматически предоставляет SSL-сертификат.

### 2. Разрешения браузера
Пользователи должны разрешить доступ к микрофону при первом использовании.

### 3. Chrome/Edge рекомендованы
- Chrome: полная поддержка
- Edge: полная поддержка
- Firefox: ограниченная поддержка
- Safari: не рекомендуется

## Проверка работоспособности

После развертывания:

1. Откройте сайт в Chrome
2. Зарегистрируйтесь
3. Загрузите тестовое аудио (до 1 минуты)
4. Разрешите доступ к микрофону при запросе
5. Нажмите "Начать транскрибацию"
6. Дождитесь завершения (примерно 40 секунд для 1-минутного аудио)

## Устранение проблем после деплоя

### Проблема: "Не удалось подключиться к Supabase"
- Проверьте переменные окружения в Netlify
- Убедитесь, что они начинаются с `VITE_`
- Пересоберите сайт после добавления переменных

### Проблема: "Storage bucket not found"
1. Откройте Supabase Dashboard
2. Storage → Создайте bucket `audio-files`
3. Сделайте его публичным
4. Примените политики безопасности из миграций

### Проблема: 404 при обновлении страницы
- Убедитесь, что создан файл `public/_redirects`
- Содержимое: `/*    /index.html   200`

## Оптимизация производительности

1. **Включите кэширование**
   В `netlify.toml`:
   ```toml
   [[headers]]
     for = "/assets/*"
     [headers.values]
       Cache-Control = "public, max-age=31536000, immutable"
   ```

2. **Сжатие**
   Netlify автоматически сжимает файлы с помощью Brotli

3. **CDN**
   Netlify Edge автоматически распределяет ваш сайт по всему миру

## Мониторинг

- Используйте Netlify Analytics для отслеживания использования
- Supabase Dashboard → Logs для просмотра ошибок базы данных
- Chrome DevTools → Console для отладки на стороне клиента
